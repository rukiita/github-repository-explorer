今回は前回のcrypto-dashboardで残った課題+新しい技術という前提で課題に取り組みました。

//Gif画像

・技術スタック
言語:TypeScript
フレームワーク:Next.js
state/Cache:TanStack Query,Zustand,localstorage
hooks:CustomHooks
UI/UX:Shadcn UI,TailWind CSS

・テーマ
GitHubのリポジトリに検索・閲覧・お気に入り管理できるシステム

・要件
無限スクロール、テーマ切替、ページ遷移を伴うアプリケーション、お気に入り機能、何らかのアルゴリズムを組み込んだ機能、E2Eテスト

・開発の流れ
1日目:アーキテクチャとAPI調査、ライブラリインストール

前回はクライアントから直接APIリクエストをしてしまっていました、トークンの隠蔽ができておらず、APIの抽象化もできていない状態です。これはセキュリティ上よくないです。

今回のアプリはREADMEを取得しなければならないため、その前提のリポジトリを取得する必要があると想定しました。まずはGitHubのAPIドキュメントを確認しました。しかし下記の2点で時間を取られました。
・APIを利用するにはprocess access tokenかGithubAppを使用する必要があるらしいが、どちらを採用すべきか。
・リポジトリのAPIリクエストの書き方はわかったものの、クライアント→Hooks等で最適化→route.ts→GitHubAPIの処理の流れを理解して、ファイル構造を決める。

GitHubのAPIとNext.jsの仕様の理解がどちらも不足しており、なんとなく外観はつかめているが具体的に作っていくところで壁がありました。一旦これらの問題は保留にして、必要となるライブラリインストールで終わりました。

2日目:route.tsとhooks実装、zodでレスポンスの型定義

前日での大まかな処理の流れを具体化するためにAIに質問しながら、RouteHandlerの仕様を理解していきました。それに伴いroute.tsとhooksの実装を進めました。またGitHubAPIのレスポンスの型情報は複雑なため、プロパティがわからず表示できない瞬間に出会い、そこでzodの必要性を体感しました。zodでレスポンスをパースすることで確実なRepository型を取得できるようになりました。



3日目: zustandによるキャッシュ機能、無限スクロール、パンくずリスト機能追加、

キャッシュ機能:zustandで検索したリポジトリ情報やクエリ情報をローカルストレージに保存する機能を追加しました。これはアプリを閉じても直近に検索したリポジトリ情報をわざわざ検索しなくてもアクセスできるようにするための機能です。
無限スクロール機能:useInviewとuseInfiniteQueryをセットで利用することも良いチップスになりました。
パンくずリスト機能:検索時のクエリパラメータを保存し、それを遷移後ページで呼び出し、Homeボタンに設定します。Homeボタンをクリックすると、TanStack Queryでキャッシュされた検索後のページに遷移できるというロジックです。TanStack Queryとzustandの相性がいいことに気づけました。

4日目: データフローテスト、README推敲、Vercelにデプロイ